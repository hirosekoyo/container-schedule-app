忘備録
 col-spanで表示の割合を調整できる。
基本的にはプラス１５メートル、マイナス１４メートルのルールなのに、たまにポートオブ博多でマイナす１５の時があり、それには対応していない。

３３から３５ビットの間隔は３０メートルではないので注意

使い方ガイドにスマホのPWAのURL
印刷時に倍率を100％にする。入りきらない場合だけ倍率を下げる。
印刷プレビューを閉じるときは、タブを直接閉じるのではなく、キャンセルボタンを押す。（テキストボックスが入力できなくなる）

型定義更新
npx supabase gen types typescript --linked > src/types/database.types.ts

 
作業メモ

　今まで色々な要件を追加したため、インポート時の処理が錯綜しているかもしれません。改めて要件を定義しますので、一から作成してください。インポート処理やDB関数を。
インポート処理の要件
・インポートするデータから、berth_number、arrival_time、departure_time、arrival_side、bow_position_m、stern_position_mの６つの値を連結して、data_hashの値にする。
・schedule_dateとship_nameが存在しない場合、各項目をinsertする
・schedule_dateとship_nameが存在しするばあい、以下の条件で任意の項目だけ更新する。
・schedule_dateとship_nameが存在していて、data_hashの値が同じ場合、last_import_idのみ更新する。
・schedule_dateとship_nameが存在していて、data_hashの値が異なる場合、新しいデータ（berth_number、arrival_time、departure_time、arrival_side、bow_position_m、stern_position_mのいずれかのみ）とlast_import_id更新する。さらに更新のあったフィールドの項目名でchanged_fieldsを更新する。
・berth_numberが”5”の船はschedule_dateとship_nameで存在確認をして以下の条件で必ずupsertする。
・berth_numberが”5”の船はparser.tsで指定したremarksの値とchanged_fields[ "bow_position_m","stern_position_m"固定値]の値を必ず更新する。

data_hashをberth_number、arrival_time、departure_time、arrival_side、bow_position_m、stern_position_mの６つにする。

hakata@futo.com
373150


https://maskable.app/editor
https://www.pwabuilder.com/imageGenerator
アイコン作成サイト


「将来、別のAIや開発者に引き継ぐ際に、この要件定義書だけでプロジェクトを完全に再現できるか」という観点で、要件定義書を更新してください。
プロジェクトディレクトリ構成と各ファイルの概要説明も最新化してください。
以下の現在のバージョンをもとに作成して、要件定義書全体を表示してください。

いい感じです。33ビットより左にはみ出している船も正しく描画されるようになりました。

次はミーティング時間とかわし早出時間、会社を設定する部品をお願いします。
ic_dailテーブルのmeeting_time、kawasi_time、companyがそれぞれ対応します。
風速情報と点検予定の間に配置します。3つで一つの横ならびのブロックにしてください。
ミーティング時間とかわし早出時間は時間入力に最適な入力方法で
会社は以下のComboboxとSTEVEDORE_OPTIONS.mapを利用したいので参考にしてください。
<div className="col-span-2"><Label>GC運転</Label><Combobox options={STEVEDORE_OPTIONS.map(val => ({ value: val, label: val }))} value={op.stevedore_company || ''} onChange={(value) => handleOperationChange(index, { target: { name: 'stevedore_company', value } } as any)} placeholder="会社を選択..." /></div>




実装したい

アナリティクス

済み　風速情報を別コンポーネントにして、風速によって色を帰る。
済み　風を色分け、ガントチャートを３時間毎にして、風によって色分け
済み　荷役予定詳細にPとTを追加する。
済み　荷役予定詳細に印刷時だけ、強風連絡項目を入れる。
済み　点検区分を追加する。
済み　かわし、ミーティング追加。
済み　アンカー位置最新化
pilot,tugの項目追加


schedulesテーブルにpilot、tugのカラムを追加してください。
どちらもboolean型で、デフォルトはfalseです。
予定編集モーダルにpilot、tugのチェックボックスを追加してください。チェックを入れるとtrue、外すとfalseになります。
追加する場所は、船名と同じ行で、PILOT、TUGというラベルにしてください。
表示領域の割合は船名６割、PILOT２割，TUG２割、岸壁２割にして、この順番に並べてください。
また、日次レポートモーダルと同様に保存ボタンをフォームの外に出して、スクロールしても押しやすいようにしてください。
以下の現在のバージョンをもとに修正してください。



極限情報を最新晩にする。

プランなを代理店ではなく荷役会社からインポートする。

IC終了点検区分表をつける。
テーブルに点検項目を追加する。１、２、３これをconstants.tsで定義した文字列を呼び出す。

スマホアプリ更新時間表示をつける。

ダッシュボード画面に香椎IC切り替えボタンを作る。
パーサーとガントチャートコンポーネントだけ香椎用を作ればよい？
リセットボタンでIC香椎消えるようにしても大丈夫！

スマホのIC香椎出し分けは、IDで分けるか、キャッシュで直近に開いていた方を覚えるか？

 香椎とICのテーブルどうするか？
 テーブルに香椎ICの列を追加する。か
 香椎用のテーブルを作るか？